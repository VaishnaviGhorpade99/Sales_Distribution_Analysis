1. Total Sales By Region
SELECT
c.Region,
SUM(s.TotalAmount) AS TotalSales
FROM sales s
JOIN customers c ON s.CustomerID = c.CustomerID
GROUP BY c.Region;

2. Monthly Sales Trend
SELECT
d.Year,
d.Month,
SUM(s.TotalAmount) AS MonthlySales
FROM sales s
JOIN date_dim d ON s.OrderDate = d.Date
GROUP BY d.Year, d.Month
ORDER BY d.Year, d.Month;

3. Top 10 Products by Sales
SELECT
p.ProductName,
SUM(s.TotalAmount) AS TotalSales
FROM sales s
JOIN products p ON s.ProductID = p.ProductID
GROUP BY p.ProductName
ORDER BY TotalSales DESC
LIMIT 10;

4. Profit by Product
SELECT
p.ProductName,
SUM(s.Quantity * (s.UnitPrice - p.CostPrice)) AS TotalProfit
FROM sales s
JOIN products p ON s.ProductID = p.ProductID
GROUP BY p.ProductName
ORDER BY TotalProfit DESC;

5. Sales by Customer Segment
SELECT
c.Segment,
SUM(s.TotalAmount) AS TotalSales
FROM sales s
JOIN customers c ON s.CustomerID = c.CustomerID
GROUP BY c.Segment;

6. Average Order Value (AOV)
SELECT
AVG(s.TotalAmount) AS AverageOrderValue
FROM sales s;

7. Year-over-Year (YoY) Sales Growth
SELECT
d.Year,
SUM(s.TotalAmount) AS Sales,
LAG(SUM(s.TotalAmount)) OVER (ORDER BY d.Year) AS LastYearSales,
ROUND((SUM(s.TotalAmount) - LAG(SUM(s.TotalAmount)) OVER (ORDER BY d.Year))
/ NULLIF(LAG(SUM(s.TotalAmount)) OVER (ORDER BY d.Year), 0) * 100, 2) AS YoY_Growth_Percent
FROM sales s
JOIN date_dim d ON s.OrderDate = d.Date
GROUP BY d.Year
ORDER BY d.Year;

8. Discount Impact Analysis
SELECT
ROUND(AVG(s.Discount) * 100, 2) AS Avg_Discount_Percentage,
SUM(s.TotalAmount) AS TotalSales
FROM sales s;

9. Sales by Category and Subcategory
SELECT
p.Category,
p.SubCategory,
SUM(s.TotalAmount) AS TotalSales
FROM sales s
JOIN products p ON s.ProductID = p.ProductID
GROUP BY p.Category, p.SubCategory;

10. Customers with Highest Revenue
SELECT
c.CustomerName,
SUM(s.TotalAmount) AS TotalRevenue
FROM sales s
JOIN customers c ON s.CustomerID = c.CustomerID
GROUP BY c.CustomerName
ORDER BY TotalRevenue DESC
LIMIT 10;






















